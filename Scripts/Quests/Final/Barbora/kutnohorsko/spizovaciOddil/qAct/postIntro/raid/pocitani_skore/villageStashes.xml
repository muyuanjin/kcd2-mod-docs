<?xml version="1.0" encoding="utf-8"?>
<Database xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Name="brambora">
	<Skald>
		<Module Name="villageStashes">
			<Ports>
				<Port Name="init" Direction="In" Type="trigger">
					<DesignName StringName="villagest_init_u34P" Text="Init" />
				</Port>
				<Port Name="value_of_loot_stolen_from_villagers" Direction="Out" Type="int">
					<DesignName StringName="villagest_value_of_loot_s_Ryuz" Text="Value of loot stolen from villagers" />
				</Port>
				<Port Name="recalculate_loot_value_in_stashes" Direction="Out" Type="trigger">
					<DesignName StringName="villagest_recalculate_loo_RFmd" Text="Recalculate loot value in stashes - patch" />
				</Port>
				<Port Name="stashwatchactive" Direction="In" Type="bool">
					<DesignName StringName="villagest_stashwatchactive_FUqC" Text="StashWatchActive" />
				</Port>
				<Port Name="domluveno" Direction="In" Type="bool">
					<DesignName StringName="villagest_domluveno_UuVx" Text="Domluveno s velitelem na začátku" />
				</Port>
			</Ports>
			<Definitions>
				<Definition File="villageStashes/patch_for_kcd2511105.xml" />
			</Definitions>
			<Nodes>
				<stashitemsandtriggers Name="AllStashItems" PositionY="-4160" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash1TreeDestroStash" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1" PositionY="-3940" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash1" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1" PositionY="-3720" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash2" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1" PositionY="-3500" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash3" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1" PositionY="-3280" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash4" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_1" PositionY="-3060" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash5" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_1_1" PositionY="-2410" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash8" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_1_1_1" PositionY="-1980" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash10" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_1_1_1_1" PositionY="-1550" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash12" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_1_1_1_1_1" PositionY="-890" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash15" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_1_1_1_1_1_1" PositionY="-680" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash16" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_1_1_1_2" PositionY="-1330" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash13" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_2" PositionY="-2630" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash7" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_2_1" PositionY="-2190" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash9" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_2_1_1" PositionY="-1760" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash11" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_1_2_1_1_1" PositionY="-1110" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash14" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_1_1_1_2" PositionY="-2850" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash6" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<stashitemsandtriggers Name="AllStashItems_2" PositionY="-460" PositionX="-1010" Namespace="utils.item">
					<Asset Name="stash" Alias="hiddenStash2DestroStash" />
					<Edge From="and21.bool" To="isactive">
						<Vertex>vertex11</Vertex>
					</Edge>
				</stashitemsandtriggers>
				<Function Name="and21" PositionY="-370" PositionX="-1620" MethodName="math::boolean::And" DeclaringType="math::boolean">
					<Edge From="stashwatchactive" To="A" />
					<Edge From="domluveno" To="B" />
				</Function>
				<CalculateItemsValueInStash Name="CalculateItemsValueInStash" PositionY="-140" PositionX="-70" Namespace="spizovacioddil_utils">
					<Edge From="joinarrays7.Array" To="items" />
					<Edge From="AllStashItems_1_1_1_1_1_1_1_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_1_1_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_2_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_1_1_1_2.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_1_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_2_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_2_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_2.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_2.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="AllStashItems_1.onclosed" To="recalculatestashcontentvalue">
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="init" To="recalculatestashcontentvalue">
						<Vertex>vertex15</Vertex>
						<Vertex>vertex12</Vertex>
					</Edge>
					<Edge From="itemdescriptortrigger18.OnAfterLose" To="recalculatestashcontentvalue" />
					<Edge From="itemdescriptortrigger18_1.OnAfterLose" To="recalculatestashcontentvalue" />
					<Edge From="patch_for_kcd2511105.recalculate_loot_value_in_stashes" To="recalculatestashcontentvalue">
						<Vertex>T6dl2Rzf</Vertex>
						<Vertex>YD8uWk8L</Vertex>
					</Edge>
				</CalculateItemsValueInStash>
				<Constants_lootScore Name="Constants_lootScore" PositionY="1830" PositionX="-80" Namespace="spizovacioddil_utils" />
				<Function Name="createitemclassdescriptor20" PositionY="240" PositionX="-1140" MethodName="wh::entitymodule::CreateItemClassDescriptor" DeclaringType="wh::entitymodule">
					<Constant Name="ItemClass" Value="1657b964-9a6b-4e74-af81-7fe06d50cf12" />
				</Function>
				<Function Name="createitemclassdescriptor20_1" PositionY="1040" PositionX="-1130" MethodName="wh::entitymodule::CreateItemClassDescriptor" DeclaringType="wh::entitymodule">
					<Constant Name="ItemClass" Value="5ef63059-322e-4e1b-abe8-926e100c770e" />
				</Function>
				<State Name="currentVillageLootValueLeftUntouched" PositionY="70" PositionX="780" TypeT="int">
					<Constant Name="DefaultValue" Value="0" />
					<Edge From="CalculateItemsValueInStash.value" To="Value" />
					<Edge From="CalculateItemsValueInStash.oncalculationfinished" To="Exec" />
				</State>
				<IfFunction Name="ifcompare8" PositionY="-200" PositionX="470" TypeT="int" MethodName="Control::Compare" DeclaringType="Control">
					<Constant Name="Op" Value="Equals" />
					<Constant Name="ValueB" Value="0" />
					<Edge From="initialVillageLootValue.State" To="ValueA">
						<Vertex>vertex4</Vertex>
						<Vertex>vertex5</Vertex>
					</Edge>
					<Edge From="select22.OnExec" To="Exec" />
				</IfFunction>
				<IfFunction Name="ifispatchingphase33" PositionY="300" PositionX="530" MethodName="wh::conceptmodule::IsPatchingPhase" DeclaringType="wh::conceptmodule">
					<Edge From="select22.OnExec" To="Exec" />
				</IfFunction>
				<State Name="initialVillageLootValue" PositionY="-190" PositionX="780" TypeT="int">
					<Constant Name="DefaultValue" Value="0" />
					<Edge From="ifcompare8.True" To="Exec" />
					<Edge From="select22.Value1" To="Value" />
					<Edge From="ifispatchingphase33.True" To="Exec" />
				</State>
				<ItemDescriptorTrigger Name="itemdescriptortrigger18" PositionY="-40" PositionX="-690">
					<Edge From="stashproperties19.Inventory" To="Inventory" />
					<Edge From="createitemclassdescriptor20.ItemDescriptor" To="ItemDescriptor" />
					<Edge From="and21.bool" To="IsActive" />
				</ItemDescriptorTrigger>
				<ItemDescriptorTrigger Name="itemdescriptortrigger18_1" PositionY="760" PositionX="-700">
					<Edge From="stashproperties19_1.Inventory" To="Inventory" />
					<Edge From="createitemclassdescriptor20_1.ItemDescriptor" To="ItemDescriptor" />
					<Edge From="and21.bool" To="IsActive">
						<Vertex>92T5hV5M</Vertex>
					</Edge>
				</ItemDescriptorTrigger>
				<Function Name="joinarrays7" PositionY="-1000" PositionX="-360" TypeT="wh::entitymodule::Items" MethodName="utilities::array::JoinArrays" DeclaringType="utilities::array">
					<Edge From="AllStashItems.items" To="A" />
					<Edge From="AllStashItems_1.items" To="B" />
					<Edge From="AllStashItems_1_1.items" To="C" />
					<Edge From="AllStashItems_1_1_1.items" To="D" />
					<Edge From="AllStashItems_1_1_1_1.items" To="E" />
					<Edge From="AllStashItems_1_1_1_1_1.items" To="F" />
					<Edge From="AllStashItems_1_1_1_2.items" To="G" />
					<Edge From="AllStashItems_1_1_1_1_2.items" To="H" />
					<Edge From="AllStashItems_1_1_1_1_1_1.items" To="I" />
					<Edge From="AllStashItems_1_1_1_1_2_1.items" To="J" />
					<Edge From="AllStashItems_1_1_1_1_1_1_1.items" To="K" />
					<Edge From="AllStashItems_1_1_1_1_2_1_1.items" To="L" />
					<Edge From="AllStashItems_1_1_1_1_1_1_1_1.items" To="M" />
					<Edge From="AllStashItems_1_1_1_1_1_1_1_2.items" To="N" />
					<Edge From="AllStashItems_1_1_1_1_2_1_1_1.items" To="O" />
					<Edge From="AllStashItems_1_1_1_1_1_1_1_1_1.items" To="P" />
					<Edge From="AllStashItems_2.items" To="R" />
					<Edge From="AllStashItems_1_1_1_1_1_1_1_1_1_1.items" To="Q" />
				</Function>
				<Output Name="Output">
					<Edge From="sub9.int" To="value_of_loot_stolen_from_villagers" />
					<Edge From="patch_for_kcd2511105.recalculate_loot_value_in_stashes" To="recalculate_loot_value_in_stashes">
						<Vertex>HGnfIlm8</Vertex>
					</Edge>
				</Output>
				<patch_for_kcd2511105 Name="patch_for_kcd2511105" PositionY="1670" PositionX="270">
					<Edge From="stashwatchactive" To="stashwatchactive">
						<Vertex>I7LRa5rl</Vertex>
					</Edge>
				</patch_for_kcd2511105>
				<Select Name="select22" PositionY="110" PositionX="290" InputPortGroups="2" ValueTypes="int">
					<Edge From="CalculateItemsValueInStash.oncalculationfinished" To="SelectA" />
					<Edge From="CalculateItemsValueInStash.value" To="AValue1" />
					<Edge From="Constants_lootScore.release_1_2_hodnota_cennosti" To="BValue1" />
					<Edge From="patch_for_kcd2511105.reinitialise_overall_loot_value" To="SelectB">
						<Vertex>tDGSbxFS</Vertex>
					</Edge>
				</Select>
				<ObjectProperties Name="stashproperties19" PositionY="120" PositionX="-1090" DeclaringType="wh::entitymodule::Stash">
					<Asset Name="Stash" Alias="hiddenStash1TreeDestroStash" />
				</ObjectProperties>
				<ObjectProperties Name="stashproperties19_1" PositionY="920" PositionX="-1080" DeclaringType="wh::entitymodule::Stash">
					<Asset Name="Stash" Alias="hiddenStash2DestroStash" />
				</ObjectProperties>
				<Function Name="sub9" PositionY="-40" PositionX="1180" MethodName="math::integer::Sub" DeclaringType="math::integer">
					<Edge From="initialVillageLootValue.State" To="A" />
					<Edge From="currentVillageLootValueLeftUntouched.State" To="B" />
				</Function>
			</Nodes>
			<EdgeVertices>
				<EdgeVertex Name="92T5hV5M" PositionY="837" PositionX="-1162" />
				<EdgeVertex Name="HGnfIlm8" PositionY="1837" PositionX="946" />
				<EdgeVertex Name="I7LRa5rl" PositionY="1723" PositionX="-1499" />
				<EdgeVertex Name="T6dl2Rzf" PositionY="870" PositionX="460" />
				<EdgeVertex Name="tDGSbxFS" PositionY="890" PositionX="460" />
				<EdgeVertex Name="vertex11" PositionY="-2290" PositionX="-1290" />
				<EdgeVertex Name="vertex12" PositionY="-110" PositionX="-520" />
				<EdgeVertex Name="vertex15" PositionY="-104" PositionX="-1373" />
				<EdgeVertex Name="vertex4" PositionY="-300" PositionX="990" />
				<EdgeVertex Name="vertex5" PositionY="-300" PositionX="490" />
				<EdgeVertex Name="YD8uWk8L" PositionY="870" PositionX="-60" />
			</EdgeVertices>
			<Notes>
				<Note Name="note24" PositionY="1880" PositionX="260">
					<Text StringName="villagest_note24_Sctm" Text="Release_1_2 initialVillageLootValue&#xD;&#xA;15197&#xD;&#xA;&#xD;&#xA;Oprava KCD2-511105 S31 Spižovací oddíl – food has now too little value, it is never enough&#xD;&#xA;- problém je, že sa počas ladenia cien zmenili ceny jedla a iných cenností vesničanov. To quest rozbíja ak hráč začal hrať na 1.1 a pokračoval na 1.2&#xD;&#xA;&#xD;&#xA;Int stav initialVillageLootValue kvôli tomu už nemá správnu hodnotu. Int sa inicializuje na začiatku questu sčítaním lootu každej stashe, &#xD;&#xA;V 1.2 musíme int správne nastaviť. To už ale nie je možné tak ako pri inicializácii, pretože hráč mohol truhly vylootovať. Preto potrebujeme nastaviť int v patchi konkrétnou konstantou." />
				</Note>
			</Notes>
			<Text StringName="villagestashes_dDhk" Text="Skrytý majetek vesničanů" />
			<Elements>
				<GameplayActionElement>
					<Text StringName="villagest_pri_zacatku_rab_08x6" Text="Při začátku rabování spočítá hodnotu věcí ve sledovaných stashích (možná přidáme i sloty, pokud budou). Paslety s připravenými itemy se nepočítají! Pak při každé interakci s těmito stashemi/sloty spočítá zbylou celkovou hodnotu. Při příliš vysokém rozdílu už budou vesničani naštvaní." />
				</GameplayActionElement>
			</Elements>
		</Module>
	</Skald>
</Database>